Ladies and gentlemen,

I have created a list of SQL queries to check within the project, which I have included below.

Please feel free to check who bought what and when.


-- Q1: List all characters (basic SELECT)
SELECT * FROM characters;

-- Q2: List products with price > 50
SELECT name, price FROM products WHERE price > 50;

-- Q3: Transactions on a specific date
SELECT * FROM transactions WHERE tx_date = '2024-01-02';

-- Q4: Products with their category name (JOIN)
SELECT p.name AS product, c.name AS category
FROM products p
JOIN categories c ON p.category_id = c.category_id;

-- Q5: Items in each transaction (multi-table JOIN)
SELECT t.transaction_id, c.name AS customer, p.name AS product, ti.quantity
FROM tx_items ti
JOIN transactions t ON ti.transaction_id = t.transaction_id
JOIN products p ON ti.product_id = p.product_id
JOIN characters c ON t.character_id = c.character_id
ORDER BY t.transaction_id;

-- Q6: Number of transactions per character (GROUP BY)
SELECT ch.name, COUNT(t.transaction_id) AS transactions_count
FROM characters ch
LEFT JOIN transactions t ON ch.character_id = t.character_id
GROUP BY ch.name
ORDER BY transactions_count DESC;

-- Q7: Top selling product by quantity
SELECT p.name, SUM(ti.quantity) AS total_sold
FROM tx_items ti
JOIN products p ON ti.product_id = p.product_id
GROUP BY p.product_id, p.name
ORDER BY total_sold DESC
LIMIT 1;

-- Q8: Characters who bought more than 3 items (HAVING)
SELECT ch.name, SUM(ti.quantity) AS items_bought
FROM characters ch
JOIN transactions t ON ch.character_id = t.character_id
JOIN tx_items ti ON t.transaction_id = ti.transaction_id
GROUP BY ch.name
HAVING SUM(ti.quantity) > 3;

-- Q9: Classify customers by total spending (CASE + aggregation)
SELECT ch.name, SUM(ti.quantity * p.price) AS total_spent,
  CASE
    WHEN SUM(ti.quantity * p.price) > 200 THEN 'High spender'
    WHEN SUM(ti.quantity * p.price) > 50 THEN 'Medium spender'
    ELSE 'Low spender'
  END AS spender_type
FROM characters ch
JOIN transactions t ON ch.character_id = t.character_id
JOIN tx_items ti ON t.transaction_id = ti.transaction_id
JOIN products p ON ti.product_id = p.product_id
GROUP BY ch.name
ORDER BY total_spent DESC;

-- Q10: Total revenue of the shop
SELECT SUM(ti.quantity * p.price) AS total_revenue
FROM tx_items ti
JOIN products p ON ti.product_id = p.product_id;


